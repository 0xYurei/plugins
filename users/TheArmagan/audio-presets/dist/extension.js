(function(u,c,p,d){"use strict";function s(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var h=s(c),m=s(p);class f{constructor(){this.patches=[]}add(...e){this.patches.push(...e)}remove(e){let[a]=this.patches.splice(this.patches.indexOf(o=>o==e),1);a()}removeAll(){let e=this.patches.splice(0,this.patches.length);for(let a=0;a<e.length;a++)e[a]()}}var i=new f,g={load(){const t=m.default.find(e=>e?.prototype?._ensureAudio,!0);i.add(h.default.instead("_ensureAudio",t.prototype,function(e,a){let o=this,l=Object.fromEntries(u.persist.ghost.settings.preset.split(";").map(r=>r.split("=")));if(l[this.name]){let r=l[this.name];return r.startsWith("https://")?new Promise((_,v)=>{let n=new Audio;n.onloadeddata=function(){n.volume=Math.min(d.MediaEngineStore.getOutputVolume()/100*o._volume,1),_(n)},n.onerror=function(){return v(new Error("could not play audio"))},n.onended=function(){return o._destroyAudio()},n.load(),n.src=r}):(this.name=r,a.apply(this,e))}else return a.apply(this,e)}))},unload(){i.removeAll()},settings:{data:[{type:"input",altType:"text",property:"preset",value:"message1=message2;call_ringing=call_ringing_beat",placeholder:"message1=message2;call_ringing=call_ringing_beat",name:"Audio Preset",description:"Your audio preset configuration..",size:"large"}]}};return g})(acord.extension,acord.patcher,acord.modules.webpack,acord.modules.common);
