(function(h,u,r,x){"use strict";function g(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function v(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(o){if(o!=="default"){var n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,n.get?n:{enumerable:!0,get:function(){return e[o]}})}}),t.default=e,Object.freeze(t)}var i=v(h),y=g(u);class w{constructor(){this.patches=[]}add(...t){this.patches.push(...t)}remove(t){let[o]=this.patches.splice(this.patches.indexOf(n=>n==t),1);o()}removeAll(){let t=this.patches.splice(0,this.patches.length);for(let o=0;o<t.length;o++)t[o]()}}var d=new w,E=()=>x.injectCSS(".sb--modal-root{display:flex;flex-direction:column}.sb--modal-root .sb--modal-header{display:flex;align-items:center;justify-content:space-between;padding:16px}.sb--modal-root .sb--modal-header .title{font-size:28px;font-weight:600;color:#efefef}.sb--modal-root .sb--modal-header .sb--modal-close{width:24px;height:24px;cursor:pointer}.sb--modal-root .sb--modal-header .sb--modal-close svg{width:24px;height:24px}.sb--modal-root .sb--modal-content{padding:0 16px 16px;display:flex;flex-direction:column;justify-content:space-between;height:100%}.sb--modal-root .sb--modal-content .disabled{opacity:.25;pointer-events:none}.sb--modal-root .sb--modal-content>.top{display:flex;flex-direction:column}.sb--modal-root .sb--modal-content>.top>.content{width:100%;display:flex;flex-wrap:wrap;align-items:center;justify-content:flex-start;gap:8px}.sb--modal-root .sb--modal-content>.top>.content .item{width:120px;max-width:120px;padding:8px;background-color:#00000040;color:#fff;display:flex;align-items:center;justify-content:center;border-radius:8px;cursor:pointer}.sb--modal-root .sb--modal-content>.top>.content .item .text{display:flex;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;width:112px;text-align:center}.sb--modal-root .sb--modal-content>.controls-container{width:100%;display:flex;align-items:center;justify-content:center;margin-top:8px}.sb--modal-root .sb--modal-content>.controls-container .controls{display:flex;gap:8px;padding:8px;border-radius:8px;background-color:#0000001a;color:#fff;align-items:center;transition:.25s ease-in-out opacity}.sb--modal-root .sb--modal-content>.controls-container .controls .arrow{font-weight:800;font-size:20px;cursor:pointer;color:#f5f5f5d9;transition:.25s ease-in-out opacity}");const{modals:{actions:{show:C},ModalRoot:S},React:a}=y.default,N={DANGER:"#eb3d47",SECONDARY:"#8a8e93",SUCCESS:"#3aa360",PRIMARY:"#5865f2"};function O(e={}){return i.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:"aka--icon aka--close-icon",style:{color:e.color}},i.createElement("path",{d:"M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z",fill:"currentColor"}))}const m=28;function j({names:e,table:t,playSound:o,e:n}){const[l,R]=a.useState({page:0,names:[]}),[A,D]=a.useState(!0);async function p(c=0){let b=e.slice(c*m,m);R({page:c,names:b}),D(!!b[(c+1)*m+1])}return a.useEffect(()=>{p(0)},[]),a.createElement(S,{transitionState:n.transitionState,size:"medium",className:"sb--modal-root"},a.createElement("div",{className:"sb--modal-header"},a.createElement("div",{className:"title"},r.i18n.format("SOUND_BOARD")),a.createElement("div",{onClick:n.onClose,className:"sb--modal-close"},a.createElement(O,{color:N.SECONDARY}))),a.createElement("div",{className:"sb--modal-content"},a.createElement("div",{className:"top"},a.createElement("div",{className:"content"},l.names.map(c=>a.createElement("div",{className:"item",onClick:()=>{o(t[c].src,t[c].volume)}},a.createElement("div",{className:"text","acord--tooltip-content":`${c} (${r.i18n.format("VOLUME",~~(t[c].volume*100))})`},c))))),a.createElement("div",{className:"controls-container"},a.createElement("div",{className:"controls"},a.createElement("div",{className:`back ${l.page==0?"disabled":""} arrow`,onClick:()=>{p(l.page-1,l.type)}},"<<"),a.createElement("div",{className:"page"},l.page+1),a.createElement("div",{className:`next ${A?"":"disabled"} arrow`,onClick:()=>{p(l.page+1,l.type)}},">>")))))}let s={audioContext:null,table:{},buffCache:{}};async function k(e,t=.5){let o=[...u.MediaEngineStore.getMediaEngine().connections],n=s.buffCache[`${e}`]||await s.audioContext.decodeAudioData(await(await fetch(`https://api.codetabs.com/v1/proxy/?quest=${e}`)).arrayBuffer());s.buffCache[`${e}`]||(s.buffCache[`${e}`]=n),o.forEach(l=>{l.startSamplesPlayback(n,t,()=>{})})}const f=_.debounce(e=>{let t=e||r.persist.ghost?.settings?.sounds||"";if(s.buffCache={},!t.trim()){s.table={};return}s.table=Object.fromEntries(t.trim().split(`
`).map(o=>{let n=o.trim().split(";");return n.length!=3?null:[n[0],{src:n[1],volume:Number(n[2])??1}]}).filter(o=>o))});var M={load(){d.add(E()),s.audioContext=new AudioContext,f(),d.add((()=>{function e(t){t.ctrlKey&&t.code=="KeyB"&&C(o=>i.createElement(j,{e:o,playSound:k,names:Object.keys(s.table),table:s.table}))}return window.addEventListener("keyup",e),()=>{window.removeEventListener("keyup",e)}})())},async unload(){d.removeAll(),s.audioContext.close(),s.audioContext=null,s.table={},s.buffCache={}},settings:{data:[{type:"textarea",property:"sounds",value:"",placeholder:"SoundName;https://discordcdnlink;0.5",name:"Sounds",description:"Each line is a new sound. Format: SoundName;SoundLink;Volume",rows:9}],update(e,t){switch(e){case"sounds":{f(t);break}}}}};return M})(acord.modules.common.React,acord.modules.common,acord.extension,acord.patcher);
