(function(v,g,b,E){"use strict";function C(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function N(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(o){if(o!=="default"){var a=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,a.get?a:{enumerable:!0,get:function(){return e[o]}})}}),t.default=e,Object.freeze(t)}var h=N(v),S=C(g);class O{constructor(){this.patches=[]}add(...t){this.patches.push(...t)}remove(t){let[o]=this.patches.splice(this.patches.indexOf(a=>a==t),1);o()}removeAll(){let t=this.patches.splice(0,this.patches.length);for(let o=0;o<t.length;o++)t[o]()}}var x=new O,k=()=>E.injectCSS(".sb--modal-root{display:flex;flex-direction:column}.sb--modal-root .sb--modal-header{display:flex;align-items:center;justify-content:space-between;padding:16px}.sb--modal-root .sb--modal-header .title{font-size:28px;font-weight:600;color:#efefef}.sb--modal-root .sb--modal-header .sb--modal-close{width:24px;height:24px;cursor:pointer}.sb--modal-root .sb--modal-header .sb--modal-close svg{width:24px;height:24px}.sb--modal-root .sb--modal-content{padding:0 16px 16px;display:flex;flex-direction:column;justify-content:space-between;height:100%}.sb--modal-root .sb--modal-content .disabled{opacity:.25;pointer-events:none}.sb--modal-root .sb--modal-content>.top{display:flex;flex-direction:column}.sb--modal-root .sb--modal-content>.top>.content{width:100%;display:flex;flex-wrap:wrap;align-items:center;justify-content:flex-start;gap:8px}.sb--modal-root .sb--modal-content>.top>.content .item{width:120px;max-width:120px;padding:8px;background-color:#00000040;color:#fff;display:flex;align-items:center;justify-content:center;border-radius:8px;cursor:pointer}.sb--modal-root .sb--modal-content>.top>.content .item .text{display:flex;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;width:112px;text-align:center}.sb--modal-root .sb--modal-content>.controls-container{width:100%;display:flex;align-items:center;justify-content:center;margin-top:8px}.sb--modal-root .sb--modal-content>.controls-container .controls{display:flex;gap:8px;padding:8px;border-radius:8px;background-color:#0000001a;color:#fff;align-items:center;transition:.25s ease-in-out opacity}.sb--modal-root .sb--modal-content>.controls-container .controls .arrow{font-weight:800;font-size:20px;cursor:pointer;color:#f5f5f5d9;transition:.25s ease-in-out opacity}");const{modals:{actions:{show:j},ModalRoot:A},React:n}=S.default,R={DANGER:"#eb3d47",SECONDARY:"#8a8e93",SUCCESS:"#3aa360",PRIMARY:"#5865f2"};function M(e={}){return h.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:"aka--icon aka--close-icon",style:{color:e.color}},h.createElement("path",{d:"M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z",fill:"currentColor"}))}const u=28;function $({names:e,table:t,playSound:o,e:a}){const[s,i]=n.useState({page:0,names:[]}),[c,d]=n.useState(!1);async function f(r=0){let m=e.slice(r*u,r*u+u);i({page:r,names:m}),d(!!m[r*u+1])}return n.useEffect(()=>{f(0)},[]),n.createElement(A,{transitionState:a.transitionState,size:"medium",className:"sb--modal-root"},n.createElement("div",{className:"sb--modal-header"},n.createElement("div",{className:"title"},b.i18n.format("SOUND_BOARD")),n.createElement("div",{onClick:a.onClose,className:"sb--modal-close"},n.createElement(M,{color:R.SECONDARY}))),n.createElement("div",{className:"sb--modal-content"},n.createElement("div",{className:"top"},n.createElement("div",{className:"content"},s.names.map(r=>n.createElement("div",{className:"item",onClick:()=>{t[r]&&o(t[r].src,t[r].volume,{begin:t[r].begin,end:t[r].begin+5e3},t[r].end)}},n.createElement("div",{className:"text","acord--tooltip-content":`${r} (${b.i18n.format("VOLUME",~~(t[r]?.volume*100))})`},r))))),n.createElement("div",{className:"controls-container"},n.createElement("div",{className:"controls"},n.createElement("div",{className:`back ${s.page==0?"disabled":""} arrow`,onClick:()=>{f(s.page-1,s.type)}},"<<"),n.createElement("div",{className:"page"},s.page+1),n.createElement("div",{className:`next ${c?"":"disabled"} arrow`,onClick:()=>{f(s.page+1,s.type)}},">>")))))}let l={audioContext:null,table:{},buffCache:{},last:""};function D(e,t,o){let a=e.duration,s=e.numberOfChannels,i=e.sampleRate;if(t=t/1e3,o=o/1e3,t<0)throw new RangeError("begin time must be greater than 0");o>a&&(o=Math.max(0,a-10));let c=i*t,d=i*o,f=d-c,r;try{r=l.audioContext.createBuffer(s,d-c,i);let m=new Float32Array(f),L=0;for(let p=0;p<s;p++)e.copyFromChannel(m,p,c),r.copyToChannel(m,p,L)}catch(m){throw m}return r}async function y(e,t=.5,o={begin:0,end:5e3},a){if(a&&o.end>a)return;let s=[...g.MediaEngineStore.getMediaEngine().connections],i=l.buffCache[`${e}`]||await l.audioContext.decodeAudioData(await(await fetch(`https://api.codetabs.com/v1/proxy/?quest=${e}`)).arrayBuffer());l.buffCache[`${e}`]||(l.buffCache[`${e}`]=i);try{let c=D(i,o.begin,o.end);l.last=`${e};${t}`,s[0].startSamplesPlayback(c,t,d=>{!d&&l.last==`${e};${t}`&&y(e,t,{begin:o.end,end:o.end+5e3},a)}),s.slice(1).forEach(d=>{d.startSamplesPlayback(c,t,()=>{})})}catch(c){console.log(c)}}const w=_.debounce(e=>{let t=e||b.persist.ghost?.settings?.sounds||"";if(l.buffCache={},!t.trim()){l.table={};return}l.table=Object.fromEntries(t.trim().split(`
`).map(o=>{let a=o.trim().split(";"),s=(Number(a[3])||0)==0?0:Number(a[3])*1e3;return a.length<2?null:[a[0],{src:a[1],volume:Number(a[2])??1,begin:s,end:(Number(a[3])||0)==0?null:s+Number(a[4])*1e3}]}).filter(o=>o))});var B={load(){x.add(k()),l.audioContext=new AudioContext,w(),x.add((()=>{function e(t){t.ctrlKey&&t.code=="KeyB"&&j(o=>h.createElement($,{e:o,playSound:y,names:Object.keys(l.table),table:l.table}))}return window.addEventListener("keyup",e),()=>{window.removeEventListener("keyup",e)}})())},async unload(){x.removeAll(),l.audioContext.close(),l.audioContext=null,l.table={},l.buffCache={},l.last=""},settings:{data:[{type:"textarea",property:"sounds",value:"",placeholder:"SoundName;https://discordcdnlink;0.5",name:"Sounds",description:"Each line is a new sound. Format: SoundName;SoundLink;Volume",rows:9}],update(e,t){switch(e){case"sounds":{w(t);break}}}}};return B})(acord.modules.common.React,acord.modules.common,acord.extension,acord.patcher);
