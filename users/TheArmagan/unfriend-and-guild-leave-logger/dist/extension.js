(function(z,G,Y,B,F,c,D,j,q){"use strict";function v(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function W(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(a){if(a!=="default"){var r=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,r.get?r:{enumerable:!0,get:function(){return e[a]}})}}),t.default=e,Object.freeze(t)}var i=W(z),A=v(G),C=v(Y),H=v(B),J=v(F);class X{constructor(){this.patches=[]}add(...t){this.patches.push(...t)}remove(t){let[a]=this.patches.splice(this.patches.indexOf(r=>r==t),1);a()}removeAll(){let t=this.patches.splice(0,this.patches.length);for(let a=0;a<t.length;a++)t[a]()}}var h=new X;function K({className:e=""}={}){return`
        <svg
            viewBox="0 0 24 24" 
            width="24" 
            height="24"
            class="uagll--icon uagll--dislike-icon ${e}"
        >
            <path fill="currentColor" d="M2.808 1.393l18.384 18.385-1.414 1.414-3.747-3.747L12 21.485 3.52 12.993c-2.04-2.284-2.028-5.753.034-8.023L1.393 2.808l1.415-1.415zm17.435 3.364c2.262 2.268 2.34 5.88.236 8.236l-1.635 1.636L7.26 3.046c1.67-.207 3.408.288 4.741 1.483 2.349-2.109 5.979-2.039 8.242.228z"/>
        </svg>
    `}const{RelationshipStore:N,UserStore:Q,GuildStore:O,modals:{actions:{show:V},ModalRoot:Z},Button:f}=H.default,ee={DANGER:"#eb3d47",SECONDARY:"#8a8e93",SUCCESS:"#3aa360",PRIMARY:"#5865f2"};function te(e={}){return i.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:"uagll--icon uagll--close-icon",style:{color:e.color}},i.createElement("path",{d:"M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z",fill:"currentColor"}))}var b=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},L={},_={},S={};Object.defineProperty(S,"__esModule",{value:!0}),S.default=Object.freeze({GET:"GET",SET:"SET",DELETE:"DELETE",UPDATE:"UPDATE"});var ae=b&&b.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_,"__esModule",{value:!0});const x=J.default,d=ae(S);function re(e,t=!1,a=()=>!0){(0,x.useRef)(e.ghost);const[,r]=(0,x.useReducer)(n=>~n,0);return(0,x.useEffect)(()=>{function n(o,l){a(o,l)&&r()}return e.on(d.default.UPDATE,n),t||(e.on(d.default.SET,n),e.on(d.default.DELETE,n)),()=>{e.off(d.default.UPDATE,n),t||(e.off(d.default.SET,n),e.off(d.default.DELETE,n))}},[]),e.ghost}_.default=re,function(e){var t=b&&b.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(e,"__esModule",{value:!0}),e.useNest=void 0;var a=_;Object.defineProperty(e,"useNest",{enumerable:!0,get:function(){return t(a).default}})}(L);const ne=C.default.findByProps("thin","scrollerBase");function oe({e}){return L.useNest(c.persist),i.createElement(Z,{transitionState:e.transitionState,size:"large",className:"uagll--modal-root"},i.createElement("div",{className:"uagll--modal-header"},i.createElement("h1",{className:"uagll--modal-title"},"Unfriend And Guild Leaves"),i.createElement("div",{className:"uagll--modal-close"},i.createElement(te,{color:ee.SECONDARY}))),i.createElement("div",{className:`uagll--modal-body ${ne.thin}`},i.createElement("section",null,i.createElement("div",{className:"section-title"},i.createElement("h1",{class:"header"},"Unfriends"),i.createElement(f,{size:f.Sizes.TINY,color:f.Colors.TRANSPARENT,onClick:()=>{c.persist.store.unfriends=[]}},"Clear"))),i.createElement("section",null,i.createElement("div",{className:"section-title"},i.createElement("h1",{class:"header"},"Guild Leaves"),i.createElement(f,{size:f.Sizes.TINY,color:f.Colors.TRANSPARENT,onClick:()=>{c.persist.store.guildLeaves=[]}},"Clear")))))}const E=C.default.findByProps("toolbar","transparent","hamburger");function ie(){h.add(A.default.patch(`section .${E.toolbar}`,e=>{if(e.childElementCount!=3)return;let t=A.default.parseHTML(`
                    <div class="${E.iconWrapper} ${E.clickable}" acord--tooltip-content="Unfriends and Guild Leaves" acord--tooltip-side="left">
                        ${K({className:E.icon})}
                    </div>
                `);t.onclick=()=>{V(a=>i.createElement(oe,{e:a}))},e.insertBefore(t,e.lastElementChild)}))}var s={},g={},y={};y.isThenable=function(t){return t!=null&&typeof t.then=="function"},y.isArrayLike=function(t){return t!=null&&typeof t.length=="number"&&t.length>=0};const{isArrayLike:le}=y;g.forEach=function(e,t,a){let r=0,n;if(le(e))return n=e.length,{next(){if(r>=n)return[!0,null];const l=t.call(a,e[r],r,e);return r++,[!1,l]}};const o=Object.keys(e);return n=o.length,{next(){if(r>=n)return[!0,null];const l=o[r++],k=t.call(a,e[l],l,e);return[!1,k]}}},g.repeat=function(e,t,a){let r,n,o;return e&&typeof e=="object"?(r=e.start||0,n=e.step||1,o=e.done):(r=0,n=1,o=e),{next(){const l=t.call(a,r);return r+=n,r>=o?[!0,l]:[!1,l]}}},g.until=function(e,t){return{next(){const a=e.call(t);return[!1,a]}}},g.forOf=function(e,t,a){const r=e[Symbol.iterator]();return{next(){const n=r.next();if(n.done)return[!0,null];const o=t.call(a,n.value,e);return[!1,o]}}};var $={},M=(()=>{if(typeof setImmediate=="function")return e=>{setImmediate(e)};if(typeof process=="object"&&typeof process.nextTick=="function")return e=>{process.nextTick(e)};if(typeof MessageChannel=="function"){const e=new MessageChannel;let t={},a=t;return e.port1.onmessage=()=>{t=t.next;const r=t.task;delete t.task,r()},r=>{a=a.next={task:r},e.port2.postMessage(0)}}return e=>{setTimeout(e,0)}})();const{isThenable:se}=y,I=$,P=M,R=1500;var ce=function(t,a=0){return new Promise((r,n)=>{let o=0;function l(){const k=Date.now();let w;try{for(;;){const[u,T]=t.next();if(se(T)){T.then(U=>{u?r(U):U===I?r():l()},n);return}if(u){r(T);return}if(T===I){r();return}if(a>0||(w=Date.now()-k,o+=w,o>1e3))break;if(!(w<10))break}}catch(u){n(u);return}if(a>0){const u=Math.min(R,Date.now()-k+a);setTimeout(l,u)}else{const u=Math.min(R,w/3);o=0,u>10?setTimeout(l,u):P(l)}}P(l)})},ue="chillout",fe="Reduce CPU usage by non-blocking async loop and psychologically speed up in JavaScript",de="5.0.0",pe="polygon planet <polygon.planet.aqua@gmail.com>",me={url:"https://github.com/polygonplanet/chillout/issues"},he={"@babel/core":"^7.8.3","@babel/preset-env":"^7.8.3",babelify:"^10.0.0",bannerify:"^1.0.1",browserify:"^16.5.0","es6-shim":"^0.35.5",eslint:"^6.8.0",karma:"^4.4.1","karma-browserify":"^6.1.0","karma-chrome-launcher":"^3.1.0","karma-detect-browsers":"^2.3.3","karma-es6-shim":"^1.0.0","karma-firefox-launcher":"^1.3.0","karma-ie-launcher":"^1.0.0","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.5","karma-safari-launcher":"^1.0.0",mocha:"^7.0.0","package-json-versionify":"^1.0.4",pidusage:"1.0.2","power-assert":"^1.6.1","uglify-js":"^3.7.5",uglifyify:"^5.0.2",watchify:"^3.11.1"},ge={node:">=8.10.0"},ye=["dist/*","src/*"],ve="https://github.com/polygonplanet/chillout",be=["acceleration","async await","asynchronous","cpu use rate","cpu utilization rate","heavy processing","iterate","iteration","lightweight","nextTick","non-blocking","optimization","optimize for loop","performance","promise","reduce cpu usage","setimmediate","waitUntil"],Ee="MIT",ke="src/index.js",we={type:"git",url:"https://github.com/polygonplanet/chillout.git"},Te={benchmark:"node benchmark/benchmark",build:"npm run compile && npm run minify",compile:"browserify src/index.js -o dist/chillout.js -s chillout -p [ bannerify --file src/banner.js ] --no-bundle-external --bare",minify:"uglifyjs dist/chillout.js -o dist/chillout.min.js --comments -c -m -b ascii_only=true,beautify=false",test:"./node_modules/.bin/eslint . && npm run build && mocha test/**/*.spec.js --timeout 10000 && karma start karma.conf.js",travis:"npm run build && mocha test/**/*.spec.js --timeout 10000 && karma start karma.conf.js --single-run",watch:"watchify src/index.js -o dist/chillout.js -s chillout -p [ bannerify --file src/banner.js ] --no-bundle-external --bare --poll=200 -v"},_e={transform:["babelify","package-json-versionify"]},Se={name:ue,description:fe,version:de,author:pe,bugs:me,devDependencies:he,engines:ge,files:ye,homepage:ve,keywords:be,license:Ee,main:ke,repository:we,scripts:Te,browserify:_e};const p=g,m=ce,{isThenable:xe,isArrayLike:De}=y,je=M,Ae=$;s.version=Se.version,s.forEach=function(t,a,r){return m(p.forEach(t,a,r))},s.repeat=function(t,a,r){return m(p.repeat(t,a,r))},s.until=function(t,a){return m(p.until(t,a))};const Ce=13;s.waitUntil=function(t,a){return m(p.until(t,a),Ce)},s.forOf=function(t,a,r){return m(p.forOf(t,a,r))},s.StopIteration=Ae,s.iterate=m,s.iterator=p,s.isThenable=xe,s.isArrayLike=De,s.nextTick=je;function Ne(){Array.isArray(c.persist.ghost.unfriends)||(c.persist.store.unfriends=[]),h.add((()=>{let e=0,t=new Set(N.getFriendIDs());async function a(){if(e)return;let r=new Set(N.getFriendIDs());await s.forEach([...t.values()],n=>{if(r.has(n))return;let o=Q.getUser(n);c.persist.store.unfriends.unshift({at:Date.now(),tag:o.tag,id:o.id,avatar:o.avatar}),j.toasts.show.info(`You are no longer friends with "${o.tag}"!`)}),t=r,await D.sleep(1e4),a()}return a(),()=>{e=1}})())}function Oe(){Array.isArray(c.persist.ghost.leavedGuilds)||(c.persist.store.leavedGuilds=[]),h.add((()=>{let e=0,t=O.getGuilds();async function a(){if(e)return;let r=O.getGuilds();await s.forEach(Object.keys(t),n=>{if(r[n])return;let o=t[n];c.persist.store.leavedGuilds.push({at:Date.now(),name:o.name,id:o.id,icon:o.icon}),j.toasts.show.info(`You are laved from "${o.name}"!`)}),t=r,await D.sleep(1e4),a()}return a(),()=>{e=1}})())}var Le=()=>q.injectCSS(".uagll--modal-root{display:flex;flex-direction:column;padding:16px}.uagll--modal-header{margin-bottom:16px;display:flex;align-items:center;justify-content:space-between}.uagll--modal-title{font-size:28px;color:#efefef;font-weight:600}.uagll--modal-close{width:24px;height:24px;cursor:pointer}.uagll--modal-close svg{width:24px;height:24px}.uagll--modal-body{display:flex;flex-direction:column;height:550px;overflow:auto;contain:content}.uagll--modal-body section{margin-top:16px;margin-bottom:8px}.uagll--modal-body .section-title{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}.uagll--modal-body .header{font-size:22px;font-weight:600;color:#efefef}");function $e(){h.add(Le())}var Me={load(){Ne(),Oe(),$e(),ie()},unload(){h.removeAll()}};return Me})(acord.modules.common.React,acord.dom,acord.modules.webpack,acord.modules.common,acord.modules.common.React,acord.extension,acord.utils,acord.ui,acord.patcher);
