(function(exports,extension,modules,common){"use strict";const transformatorRegex=/([GAD])\: ?["]((?:(?=(\\?))\3.)*?)["] ?\=> ?["]((?:(?=(\\?))\5.)*?)["] ?(?:\((\d+)\))?/gi,SendMessageStore=modules.webpack.findByProps("sendMessage","truncateMessages","patchMessageAttachments"),ref={responses:[]};function handleMessageCreate({message:e,channelId:r}){if(e.author.id==common.UserStore.getCurrentUser().id)return;const s=ref.responses.find(t=>(t.type=="A"||t.type=="G"&&e.guild_id||t.type=="D"&&!e.guild_id)&&t.matcher.test(e.content));s.rateLimit>Date.now()||(s.rateLimit=Date.now()+s.debounceLimit,SendMessageStore.sendMessage(r,{content:s.response}))}function loadResponses(val){const responseStr=val||extension.persist.ghost.settings.responses;responseStr&&(ref.responses=[...responseStr.matchAll(transformatorRegex)].map((match,type,finderRegex,_,responseStr,__,debounce)=>({type,matcher:new RegExp(finderRegex),debounceLimit:Number(debounce)||1e3,get response(){return eval(`\`${responseStr.replaceAll('\\"','"').replaceAll("`","\\`")}\``)},rateLimit:0})))}var index={load(){loadResponses(),common.FluxDispatcher.subscribe("MESSAGE_CREATE",handleMessageCreate)},unload(){ref.responses=[],common.FluxDispatcher.unsubscribe("MESSAGE_CREATE",handleMessageCreate)},settings:{data:[{type:"textarea",name:"sung3",rows:3,property:"responses",placeholder:`G: "acord" => "wow"
D: "foo" => "bar"
A: "Hello" => "world." (5000)`,value:""}],update(e,r){switch(e){case"responses":{loadResponses(r);break}}}}};return exports.default=index,exports.ref=ref,Object.defineProperty(exports,"__esModule",{value:!0}),exports})({},acord.extension,acord.modules,acord.modules.common);
